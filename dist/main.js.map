{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/scripts/loaders.js","webpack:///./src/scripts/dashboard/sound.js","webpack:///./src/scripts/collision/pos-converter.js","webpack:///./src/scripts/levels/level-draw.js","webpack:///./src/scripts/sprite.js","webpack:///./src/scripts/sprite-load.js","webpack:///./src/scripts/levels/matrix.js","webpack:///./src/scripts/collision/tile-collider.js","webpack:///./src/scripts/collision/characters-collider.js","webpack:///./src/scripts/collision/drop.js","webpack:///./src/scripts/levels/layers.js","webpack:///./src/scripts/movements/vectors.js","webpack:///./src/scripts/movements/moving_objects_boundaries.js","webpack:///./src/scripts/movements/moving_objects.js","webpack:///./src/scripts/movements/jump.js","webpack:///./src/scripts/movements/run.js","webpack:///./src/scripts/dashboard/timer.js","webpack:///./src/scripts/player.js","webpack:///./src/scripts/movements/enemy_walk.js","webpack:///./src/scripts/fixed-time-loop.js","webpack:///./src/scripts/keyboard-input.js","webpack:///./src/scripts/camera.js","webpack:///./src/scripts/dashboard/dashboard-draw.js","webpack:///./src/scripts/dashboard/button.js","webpack:///./src/scripts/game.js","webpack:///./src/scripts/princess.js","webpack:///./src/scripts/enemies.js","webpack:///./src/index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","loadImage","url","Promise","resolve","image","Image","addEventListener","src","Sound","this","sound","document","createElement","setAttribute","style","display","body","appendChild","loop","num","volume","play","pause","currentTime","PosConverter","matrix","tileSize","pos","Math","floor","pos1","pos2","posMax","ceil","range","push","posToIndex","iX","iY","tile","ytop","ybottom","xleft","xright","matches","posToIndexRange","forEach","match","getByIndex","posX","posY","createGroundLayer","sprites","tilesMatrix","tilesConvert","groundBuffer","height","width","groundBufferContext","getContext","context","camera","cameraWidth","size","x","drawFrom","start","end","clearRect","col","table","y","drawTile","redraw","drawImage","createMainBgLayer","mainBg","mainBgBuffer","mainBgBufferContext","draw","createCharacterLayer","character","characterBuffer","characterBufferContext","Sprite","tiles","Map","oppoEles","map","flip","ele","eleContext","scale","translate","set","resizeX","resizeY","loadBackgroundLayers","then","mainImg","Matrix","window","TileCollider","vel","getByRange","walk","enemyDir","distance","CharactersCollider","characters","obj","result","boundaries","isCollide","Drop","Layer","layers","charactersCollider","tileCollider","characterDrop","gameOver","layer","timestep","jump","update","run","player","checkCollisionX","checkCollisionY","check","reset","Vector","setVector","MovingObjectBoundary","getBottom","getTop","getLeft","getRight","MovingObject","Jump","duration","exactTime","velocityY","velocityX","setVolumne","Run","speed","dir","abs","Timer","time","timerBuffer","timerBufferContext","font","fillStyle","fillText","round","Player","score","timer","updateTime","resetTime","EnemyWalk","FixedTimeLoop","new_time_stamp","accumulated_time","requestId","undefined","timestamp","cancelAnimationFrame","requestAnimationFrame","KeyboardInput","rightPressed","leftPressed","spacePressed","keyDownHandler","keyUpHandler","event","preventDefault","keyCode","stop","Camera","createTitleLayer","text","titleBuffer","titleBufferContext","textAlign","createButtonLayer","button","buttonBuffer","buttonBufferContext","measureText","fontSize","textX","textY","beginPath","moveTo","arcTo","strokeStyle","stroke","hovered","fill","Button","canvas","clicked","offsetLeft","offsetTop","hoverHandler","clickHandler","buttonLayer","clientX","clientY","mousePos","last_click","handler","Game","ctx","startMusic","gameOverMusic","buttonMusic","playerMusic","gameOverView","buttons","Set","bgs","all","bg","game","startBtn","hover","e","click","removeEventListener","level","jungleImg","jungleTiles","fetch","response","clone","json","princessIdleImg","princessIdle","princessRunImg","princessRun","pIdle","pRun","princess","pRuns","pRunsIdx","length","backgrounds","background","ranges","x1","x2","y1","y2","createDashboardLayer","enemies","enemyWalkImg","enemyWalk","enemy","eWalks","enemyWalkIdx","listenKeys","fixedLoop","restartBtn","quitBtn","showMainPage","getElementsByTagName","alpha"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n","export function loadImage(url) {\n  /*\n   * We are going to return a Promise which, when we .then\n   * will give us an Image that should be fully loaded\n   */\n  return new Promise((resolve) => {\n    /*\n     * Create the image that we are going to use to\n     * to hold the resource\n     */\n    const image = new Image();\n    /*\n     * The Image API deals in even listeners and callbacks\n     * we attach a listener for the \"load\" event which fires\n     * when the Image has finished the network request and\n     * populated the Image with data\n     */\n    image.addEventListener(\"load\", () => {\n      /*\n       * You have to manually tell the Promise that you are\n       * done dealing with asynchronous stuff and you are ready\n       * for it to give anything that attached a callback\n       * through .then a realized value.  We do that by calling\n       * resolve and passing it the realized value\n       */\n      resolve(image);\n    });\n    /*\n     * Setting the Image.src is what starts the networking process\n     * to populate an image.  After you set it, the browser fires\n     * a request to get the resource.  We attached a load listener\n     * which will be called once the request finishes and we have\n     * image data\n     */\n    image.src = url;\n  });\n}\n\nexport function loadLevel(level) {\n\n  return fetch(`src/scripts/levels/${level}.json`)\n    .then((response) => {\n    \n        return(response.clone().json())\n    });\n}\n","class Sound{\n    constructor(src){\n        this.sound = document.createElement(\"audio\");\n        this.sound.src = src;\n        this.sound.setAttribute(\"preload\", \"auto\");\n        this.sound.setAttribute(\"controls\", \"none\");\n        this.sound.style.display = \"none\";\n        document.body.appendChild(this.sound);\n    }\n    \n    loop(){\n        this.sound.loop = true;\n    }\n\n    setVolumne(num){\n        this.sound.volume = num;\n    }\n\n    play(){\n        this.sound.play();\n    }\n\n    pause(){\n        this.sound.pause();\n        this.sound.currentTime = 0;\n    }\n\n}\n\nexport default Sound;","// conver the real world position to index\nclass PosConverter{\n    constructor(matrix, tileSize=30){\n        this.matrix = matrix;\n        this.tileSize = tileSize;\n    }\n\n    posToIndex(pos){\n        return Math.floor(pos/this.tileSize)\n    }\n\n    posToIndexRange(pos1, pos2){\n        const posMax = Math.ceil(pos2/this.tileSize) * this.tileSize\n        const range = [];\n        while(pos1 < posMax){\n            range.push(this.posToIndex(pos1));\n            pos1 += this.tileSize;\n        }\n        return range;\n    }\n\n    getByIndex(iX, iY){\n        const tile = this.matrix.get(iX, iY);\n        const ytop = iY* this.tileSize;\n        const ybottom = ytop + this.tileSize;\n        const xleft = iX * this.tileSize;\n        const xright = xleft + this.tileSize;\n\n        if(tile){\n            return {\n                tile,\n                ytop,\n                ybottom, \n                xleft,\n                xright \n            }\n        }\n    }\n\n    getByRange(xleft, xright, ybottom, ytop){\n        const matches = [];\n        this.posToIndexRange(xleft, xright).forEach(iX => {\n            this.posToIndexRange(ybottom, ytop).forEach(iY=>{\n                const match = this.getByIndex(iX, iY);\n                if(match){\n                    matches.push(match)\n                }\n            })\n        })\n        return matches;\n    }\n\n    matchPos(posX, posY){\n       \n        return this.getByIndex(this.posToIndex(posX), this.posToIndex(posY))\n    }\n\n}\n\nexport default PosConverter;","import PosConverter from '../collision/pos-converter';\n\nexport function drawGround(background, context, sprites) {\n\n  background.ranges.forEach(([x1, x2, y1, y2]) => {\n\n    for (let x = x1; x < x2; x++) {\n      for (let y = y1; y < y2; y++) {\n        sprites.drawTile(background.tile, context, x, y);\n      }\n    }\n  });\n}\n\nexport function createGroundLayer(sprites, tilesMatrix){\n  const tilesConvert = new PosConverter(tilesMatrix);\n\n  const groundBuffer = document.createElement('canvas');\n  groundBuffer.height = 390;\n  groundBuffer.width = 600+600;\n  const groundBufferContext = groundBuffer.getContext('2d');\n\n  function redraw(start, end){\n    groundBufferContext.clearRect(0,0,groundBuffer.width,groundBuffer.height);\n    for(let x=start; x<=end; x++){\n      const col = tilesMatrix.table[x];\n      if(col){\n        col.forEach((tile, y) => {\n          sprites.drawTile(tile.name, groundBufferContext, x-start, y)\n        })\n      }\n    }\n    \n  } \n\n  return function drawGroundLayer(context, camera){\n    const cameraWidth = tilesConvert.posToIndex(camera.size.x);\n    const drawFrom = tilesConvert.posToIndex(camera.pos.x);\n    const drawTo = cameraWidth + drawFrom;\n    redraw(drawFrom, drawTo)\n    context.drawImage(groundBuffer, Math.floor(-camera.pos.x % 30), Math.floor(-camera.pos.y));\n  }\n}\n\nexport function createMainBgLayer(mainBg){\n  const mainBgBuffer = document.createElement('canvas');\n  mainBgBuffer.height = 390;\n  mainBgBuffer.width = 600 + 50;\n  const mainBgBufferContext = mainBgBuffer.getContext('2d');\n  \n  return function drawMainBgLayer(context){\n    mainBgBufferContext.clearRect(0,0,mainBgBuffer.width,mainBgBuffer.height);\n    mainBg.draw(\"mainBg\", mainBgBufferContext, 0, 0, 2, 2);\n    context.drawImage(mainBgBuffer, 0, 0)\n\n  }\n}\n\nexport function createCharacterLayer(character){\n  const characterBuffer = document.createElement('canvas');\n  characterBuffer.height = 60;\n  characterBuffer.width = 60;\n  const characterBufferContext = characterBuffer.getContext('2d');\n  return function drawCharacterLayer(context, camera){\n    characterBufferContext.clearRect(0, 0, 60, 60);\n    character.draw(characterBufferContext);\n\n    context.drawImage(\n      characterBuffer, \n      character.pos.x - camera.pos.x, \n      character.pos.y - camera.pos.y\n      )\n    //princess.draw(context)\n  }\n}\n\n\nexport function createDashboardLayer(player) {\n  return function drawDashboardLayer(context, camera) {\n\n    player.timer.draw(context, 450, 50)\n  }\n}\n\n\nexport function createTileMatrix(backgrounds, tiles){\n  backgrounds.forEach(background => {\n    background.ranges.forEach(([x1, x2, y1, y2]) => {\n  \n      for (let x = x1; x < x2; x++) {\n        for (let y = y1; y < y2; y++) {\n          tiles.set(x, y, {name: background.tile})\n        }\n      }\n    });\n\n  })\n}","class Sprite {\n    constructor(image, width, height) {\n        this.image = image;\n        this.width = width;\n        this.height = height;\n        // this.tiles store all created sprites\n        this.tiles = new Map();\n    }\n\n    create(name, x, y, width, height){\n        const oppoEles = [false, true].map(flip => {\n            if(!width) width = this.width;\n            if(!height) height = this.height;\n            const ele = document.createElement('canvas');\n            ele.height = height;\n            ele.width = width;\n            const eleContext = ele.getContext('2d');\n\n            if(flip){\n                // rotate canvas horizontally\n                eleContext.scale(-1,1);\n                // hard coded here  \n                eleContext.translate(-15, 0);\n            }\n            \n            eleContext.drawImage(\n                this.image,\n                x,\n                y,\n                width,\n                height,\n                0,0,\n                width,\n                height\n            );\n\n            return ele;\n        })\n        this.tiles.set(name, oppoEles)\n    }\n\n    draw(name, context, x, y, resizeX=1, resizeY=1, flip=false){\n        const ele = this.tiles.get(name)[flip ? 1 : 0];\n        context.drawImage(ele, x, y, this.width*resizeX, this.height*resizeY);        \n    }\n\n    drawTile(name, context, x, y, resizeX = 1, resizeY = 1, flip=false) {\n        const ele = this.tiles.get(name)[flip ? 1 : 0];\n    \n        context.drawImage(ele, x*this.width, y*this.height, this.width * resizeX, this.height * resizeY);\n    }\n}\n\nexport default Sprite;","import Sprite from './sprite';\nimport {loadImage} from './loaders';\n\nexport function loadBackgroundLayers(){\n    return loadImage(\"src/images/main-bg.png\").then((mainImg) => {\n      const mainBg = new Sprite(mainImg, 600, 450);\n      mainBg.create(\"mainBg\", 0, 0);\n\n      return mainBg;\n    });\n}\n\nexport function loadBackgroundTiles(){\n    return loadImage(\"src/images/jungle_tileset.png\")\n        .then((jungleImg) => {\n            \n            const jungleTiles = new Sprite(jungleImg, 30, 30);\n            jungleTiles.create(\"flatGround\", 70, 225);\n            jungleTiles.create(\"ground\", 354, 210);\n            jungleTiles.create(\"greenGrass\", 161, 33);\n            jungleTiles.create('obstacleGrass', 64, 34, 80, 60);\n            return jungleTiles;\n    });\n}\n\nexport function loadPrincessIdle() {\n  return loadImage(\"src/images/princess/Idle.png\").then((princessIdleImg) => {\n\n    const princessIdle = new Sprite(princessIdleImg, 30, 30);\n    princessIdle.create(\"idle-1\", 24, 11);\n    princessIdle.create(\"idle-2\", 24, 59);\n    princessIdle.create(\"idle-3\", 24, 303);\n    return princessIdle;\n  });\n}\n\nexport function loadPrincessRun() {\n  return loadImage(\"src/images/princess/Run.png\").then((princessRunImg) => {\n\n    const princessRun = new Sprite(princessRunImg, 30, 30);\n    princessRun.create(\"run-1\", 24, 11);\n    princessRun.create(\"run-2\", 24, 59);\n    princessRun.create(\"run-3\", 24, 153);\n    return princessRun;\n  });\n}\n\nexport function loadEnemyWalk() {\n  return loadImage(\"src/images/enemies/walk.png\").then((enemyWalkImg) => {\n\n    const enemyWalk = new Sprite(enemyWalkImg, 20, 20);\n    enemyWalk.create(\"walk-1\", 29, 14);\n    enemyWalk.create(\"walk-2\", 29, 60);\n    enemyWalk.create(\"walk-3\", 29, 109);\n    return enemyWalk;\n  });\n}","class Matrix{\n    constructor(){\n        this.table = [];\n    }\n\n    set(x,y,value){\n        if(!this.table[x]){\n            this.table[x] = [];\n        }\n        this.table[x][y] = value;\n    }\n\n    get(x,y){\n        if(this.table[x]){\n            return this.table[x][y]\n        }else{\n            return undefined;\n        }\n\n    }\n}\n\nwindow.Matrix = Matrix;\n\nexport default Matrix;","import PosConverter from './pos-converter';\n\nclass TileCollider {\n    constructor(tilesMatrix) {\n        this.tiles = new PosConverter(tilesMatrix);\n    }\n\n    checkCollisionY(character){\n      \n        let y;\n        if (character.vel.y > 0) {\n            y = character.pos.y + character.size.y\n        } else if (character.vel.y < 0 ) {\n            y = character.pos.y;\n        } else {\n            return;\n        }\n        \n        const matches = this.tiles.getByRange(character.pos.x, character.pos.x + character.size.x, y, y);\n        \n            matches.forEach(match=>{\n                if (match.tile.name !== 'flatGround' && match.tile.name !== 'ground' && match.tile.name !== 'greenGrass'){\n                    return\n                }\n                if(character.vel.y > 0){\n        \n                    if (character.pos.y + character.size.y >= match.ytop) {\n                        character.pos.y = match.ytop - character.size.y;\n                        character.vel.y = 0;\n    \n                    }\n                } else if (character.vel.y < 0) {\n                    if (character.pos.y < match.ybottom) {\n                        character.pos.y = match.ybottom;\n                        character.vel.y = 0;\n                    }\n                }\n    \n            })\n\n    \n    }\n\n    checkCollisionX(character) {\n        let x;\n         \n        if (character.vel.x > 0) {\n            x = character.pos.x + character.size.x\n        } else if (character.vel.x < 0) {\n            x = character.pos.x;\n        } else {\n            return;\n        }\n\n        const matches = this.tiles.getByRange(x, x, character.pos.y, character.pos.y + character.size.y)\n\n       \n        matches.forEach(match=>{\n            if (match.tile.name !== 'flatGround' && match.tile.name !== 'ground' && match.tile.name !== 'greenGrass') {\n                return\n            }\n            if (character.vel.x > 0) { \n                if (character.pos.x + character.size.x > match.xleft) {\n                    character.pos.x = match.xleft - character.size.x;\n                    character.vel.x = 0;\n\n                    if(character.walk){\n                        character.walk.enemyDir = -1;\n                        character.walk.distance = 0;\n                    }\n                }\n            } else if (character.vel.x < 0) {\n                if (character.pos.x < match.xright) {\n                    character.pos.x = match.xright;\n                    character.vel.x = 0;\n                    if (character.walk) {\n                        character.walk.enemyDir = 1;\n                        character.walk.distance = 0;\n                    }\n                }\n            }\n\n        })\n    }\n\n}\n\nexport default TileCollider;","import Sound from '../dashboard/sound';\n\nclass CharactersCollider{\n    constructor(characters){\n        this.characters = characters;\n        this.sound = new Sound(\"src/audios/collision.wav\")\n    }\n\n    check(obj){\n        let result = false;\n        this.characters.forEach(character => {\n            if(character === obj){\n                result = false;\n                return;\n            }\n            if(character.boundaries.isCollide(obj.boundaries)){\n                //console.log('Collide! GAME OVER')\n                this.sound.play();\n                result = true;\n            }\n        })\n        return result;\n    }\n}\n\nexport default CharactersCollider;","import Sound from '../dashboard/sound';\n\nclass Drop{\n    constructor(){\n        this.sound = new Sound(\"src/audios/drop.wav\");\n    }\n\n    check(character){\n        if(character.pos.y + character.size.y > 350){\n            //console.log('Drop! Game Over!');\n            this.sound.play();\n            return true\n        }\n        return false;\n    }\n}\n\nexport default Drop;","import Matrix from './matrix';\nimport TileCollider from '../collision/tile-collider';\nimport CharactersCollider from '../collision/characters-collider';\nimport Drop from '../collision/drop';\n\nexport default class Layer {\n    constructor(){\n        this.layers = [];\n        this.tiles = new Matrix();\n        this.characters = [];\n        this.charactersCollider = new CharactersCollider(this.characters);\n        this.tileCollider = new TileCollider(this.tiles);\n        this.characterDrop = new Drop();\n        this.gameOver = false;\n    }\n\n    draw(context, camera=0){\n        this.layers.forEach(layer => {\n            layer(context, camera)\n        })\n    }\n\n    update(timestep, camera){\n        const gravity = 2000;\n        this.characters.forEach(character => {\n            // princess\n            if(character.jump){\n                character.jump.update(character, timestep);\n                character.run.update(character, timestep);\n                character.player.update(timestep);\n            }\n            \n            // enemy\n            if(character.walk){\n                character.walk.update(character, timestep);\n            }\n            \n            character.pos.x += character.vel.x * timestep;\n            this.tileCollider.checkCollisionX(character);\n\n            character.pos.y += character.vel.y * timestep;\n            this.tileCollider.checkCollisionY(character);\n                                    \n            character.vel.y += gravity * timestep;\n            \n            // Game logic, lose when drop\n            if(character.jump){\n                if(this.characterDrop.check(character)){\n                    character.player.reset();\n                    this.gameOver = true;\n                    return;\n                };\n            }\n\n        })\n        \n\n        // Game logic, lose when collide\n        this.characters.forEach(character => {\n            if(this.charactersCollider.check(character)){\n                character.player.reset();\n                this.gameOver = true;\n            };\n        })\n    }\n}\n\n","class Vector{\n    constructor(x, y) {\n        this.setVector(x, y);\n    }\n\n    setVector(x, y) {\n        this.x = x;\n        this.y = y;\n    }\n}\n\nexport default Vector;","class MovingObjectBoundary{\n    constructor(pos, size){\n        this.pos = pos;\n        this.size = size;\n    }\n\n    isCollide(obj){\n        return this.getBottom() > obj.getTop() \n            && this.getTop() < obj.getBottom() \n            && this.getLeft() < obj.getRight()\n            && this.getRight() > obj.getLeft();\n    }\n\n    getBottom(){\n        return this.pos.y + this.size.y;\n    }\n\n    getTop(){\n        return this.pos.y\n    }\n\n    getLeft(){\n        return this.pos.x\n    }\n\n    getRight(){\n        return this.pos.x + this.size.x\n    }\n}\n\nexport default MovingObjectBoundary;","import Vector from './vectors';\nimport MovingObjectBoundary from './moving_objects_boundaries';\n\nclass MovingObject{\n    constructor(){\n        this.pos = new Vector(0,0);\n        this.vel = new Vector(0, 0);\n        this.size = new Vector(0,0);\n        this.boundaries = new MovingObjectBoundary(this.pos, this.size);\n    }\n    \n    update(timestep){\n        // multiplying the velocity by the amount of time (timestep)\n        // that has passed between rendering frames\n        this.pos.x += this.vel.x * timestep ;\n        this.pos.y += this.vel.y * timestep *1.8;      \n    }\n\n}\n\nexport default MovingObject;","import Sound from '../dashboard/sound';\n\nclass Jump{\n    constructor(){\n        this.duration = 0.1;\n        this.exactTime = 0;\n        this.velocityY= 500;\n        this.velocityX = 20;\n        this.sound = new Sound(\"src/audios/jump.wav\")\n        this.sound.setVolumne(0.3)\n    }\n\n    start(){\n        this.exactTime = this.duration;\n        this.sound.play();\n    }\n\n    stop(){\n        this.exactTime = 0;\n    }\n\n    update(character, timestep){\n        if(this.exactTime > 0){    \n            character.vel.y = -this.velocityY;\n            this.exactTime -= timestep;\n        }\n\n    }\n}\n\nexport default Jump;","class Run {\n    constructor() {\n        this.speed = 300;\n        this.dir = 0;\n        this.distance = 0;\n    }\n\n    update(character, timestep) {\n \n        character.vel.x = this.speed * this.dir * timestep;\n        if (this.dir){\n            this.distance += Math.abs(character.vel.x * timestep);\n        } else{\n            this.distance = 0;\n        }\n    }\n}\n\nexport default Run;","class Timer{\n    constructor(time=0){\n        this.time = time;\n        this.timerBuffer = document.createElement('canvas');\n        this.timerBuffer.height = 390;\n        this.timerBuffer.width = 600;\n        this.timerBufferContext = this.timerBuffer.getContext('2d');\n        this.timerBufferContext.font = \"30px VT323\";\n        this.timerBufferContext.fillStyle = 'white';\n    }\n\n    updateTime(timestep){\n        this.time += timestep\n    }\n\n    resetTime(){\n        this.time = 0\n    }\n\n    draw(context, x, y){\n        this.timerBufferContext.clearRect(0,0,600,390)\n        this.timerBufferContext.fillText(`Time: ${Math.round(this.time)}`, x, y)\n\n        context.drawImage(this.timerBuffer, 0, 0)\n    }\n}\n\nexport default Timer;","// Add a player control property to princess, then add \n// timer & score to player control\n// Create a dashboard to display timer and score\nimport Timer from './dashboard/timer';\n\nclass Player{\n    constructor(){\n        this.score = 0;\n        this.timer = new Timer();\n    }\n\n    update(timestep){\n        this.timer.updateTime(timestep);\n    }\n\n    reset(){\n        this.timer.resetTime();\n    }\n}\n\nexport default Player;","class EnemyWalk {\n    constructor() {\n        this.speed = 3000;\n        this.enemyDir = -1;\n        this.distance = 0;\n    }\n\n    update(character, timestep) {\n        character.vel.x = this.speed * this.enemyDir * timestep;\n        this.distance += Math.abs(character.vel.x * timestep);\n    }\n}\n\nexport default EnemyWalk;","export default class FixedTimeLoop{\n    constructor(timestep = 1/60){\n        let accumulated_time = 0;\n        let new_time_stamp;\n        let old_time_stamp = 0;\n        this.requestId = undefined;\n        this.gameOver = false;\n        this.updateTime = (timestamp) => {\n            if(new_time_stamp === undefined){\n                new_time_stamp = timestamp;\n            }\n            accumulated_time += (timestamp - new_time_stamp)/1000;\n           \n            // only update when accumulated time > timestep\n\n                while (accumulated_time > timestep){\n                    if(this.update(timestep)==='Game Over'){\n                        this.gameOver = true;\n                    };\n                    accumulated_time -= timestep;\n                }\n                new_time_stamp = timestamp;\n                if(!this.gameOver){\n                    this.start();\n                }else{            \n                    accumulated_time = 0;\n                    cancelAnimationFrame(this.requestId);\n                    new_time_stamp = undefined;\n                    this.requestId = undefined;\n                }\n        }\n    }\n\n    start(){\n        this.requestId = requestAnimationFrame(this.updateTime)\n    }\n\n    stop(){\n        cancelAnimationFrame(this.requestId)\n    }\n\n    \n}","class KeyboardInput{\n    constructor(character){\n        this.rightPressed = false;\n        this.leftPressed = false;\n        this.spacePressed = false;\n        this.character = character;\n        this.keyDownHandler = this.keyDownHandler.bind(this);\n        this.keyUpHandler = this.keyUpHandler.bind(this);\n    }\n\n    keyDownHandler(event) {\n        event.preventDefault();\n        if (event.keyCode === 39) {\n           \n            this.character.run.dir = event.keyCode;\n            this.rightPressed = true;\n        }\n        else if (event.keyCode === 37) {\n            this.character.run.dir = -event.keyCode;\n            this.leftPressed = true;\n        }\n        if (event.keyCode === 32) {\n            // avoid jump stack\n            if (this.character.jump.exactTime === 0 && Math.abs(this.character.vel.y) < 34){\n                this.character.jump.start();\n                this.spacePressed = true;\n            }\n        }\n}\n\n    keyUpHandler(event) {\n        event.preventDefault();\n        if (event.keyCode === 39) {\n            this.character.run.dir = 0;\n            this.rightPressed = false;\n        }\n        else if (event.keyCode === 37) {\n            this.character.run.dir = 0;\n            this.leftPressed = false;\n        }\n        if (event.keyCode === 32) {\n            this.character.jump.stop();\n            this.spacePressed = false;\n        }\n    }\n\n    listenKeys(window){\n\n        window.addEventListener('keydown', this.keyDownHandler);\n        window.addEventListener('keyup', this.keyUpHandler);\n    }\n}\n\nexport default KeyboardInput;","import Vector from './movements/vectors';\n\nclass Camera{\n    constructor(){\n        this.pos = new Vector(0,0);\n        this.size = new Vector(600, 390);\n    }\n}\n\nexport default Camera;","\nexport function createTitleLayer(text, x, y, font, size=45){\n    const titleBuffer = document.createElement('canvas');\n    titleBuffer.height = 390;\n    titleBuffer.width = 600;\n    const titleBufferContext = titleBuffer.getContext('2d');\n    titleBufferContext.font = size + \"px \" + font;\n    titleBufferContext.fillStyle = \"white\";\n    titleBufferContext.textAlign = \"center\";\n    return function drawTitleLayer(context){\n        titleBufferContext.clearRect(0,0,600, 390);\n        titleBufferContext.fillText(text,x,y);\n        context.drawImage(titleBuffer, 0, 0);\n    }\n}\n\nexport function createButtonLayer(button) {\n    const buttonBuffer = document.createElement('canvas');\n    buttonBuffer.height = 390;\n    buttonBuffer.width = 600;\n    const buttonBufferContext = buttonBuffer.getContext('2d');\n    const fontSize = 25;\n    //buttonBufferContext.fillStyle = \"white\";\n    const textSize = buttonBufferContext.measureText(button.text);\n    buttonBufferContext.font = fontSize + \"px VT323\";\n    const textX = button.x + (button.width / 2) - fontSize;\n    const textY = button.y + (button.height / 2) + fontSize / 3;\n    const radius = 3;\n    buttonBufferContext.beginPath();\n    buttonBufferContext.moveTo(button.x + radius, button.y);\n    buttonBufferContext.arcTo(button.x + button.width, button.y, button.x + button.width, button.y + button.height, radius);\n    buttonBufferContext.arcTo(button.x + button.width, button.y + button.height, button.x, button.y + button.height, radius);\n    buttonBufferContext.arcTo(button.x, button.y + button.height, button.x, button.y, radius);\n    buttonBufferContext.arcTo(button.x, button.y, button.x + button.width, button.y, radius);\n    buttonBufferContext.strokeStyle = \"white\"\n    buttonBufferContext.stroke();\n    return function drawbuttonLayer(context, camera) {\n        buttonBufferContext.clearRect(0, 0, buttonBuffer.height, buttonBuffer.width);\n        if(!button.hovered){\n            buttonBufferContext.fillStyle = \"green\";\n        }else{\n            buttonBufferContext.fillStyle = \"#57AF55\"\n        }       \n        buttonBufferContext.fill();\n        buttonBufferContext.fillStyle = \"white\";\n        buttonBufferContext.fillText(button.text, textX, textY);\n        context.drawImage(buttonBuffer, 0, 0)\n    }\n}\n \n","import {createButtonLayer} from './dashboard-draw';\nclass Button{\n    constructor(text, x, y, width, height, canvas){\n        this.x = x;\n        this.y = y;\n        this.width = width;\n        this.height = height;\n        this.clicked = false;\n        this.hovered = false;\n        this.text = text;  \n        this.canvas = canvas;\n        this.offsetLeft = this.canvas.offsetLeft;\n        this.offsetTop = this.canvas.offsetTop;\n        this.hoverHandler = this.hoverHandler.bind(this);\n        this.clickHandler = this.clickHandler.bind(this);\n\n        this.buttonLayer = createButtonLayer(this)\n    }\n\n    getMousePos(event){\n        return {\n            x: event.clientX - this.offsetLeft,\n            y: event.clientY - this.offsetTop\n        };\n    }\n\n    hoverHandler(event, context){\n        event.preventDefault();\n        let mousePos = {\n            x: event.clientX - this.offsetLeft,\n            y: event.clientY - this.offsetTop\n        };\n\n        if (mousePos.x > this.x && mousePos.x < (this.x + this.width) && mousePos.y > this.y && mousePos.y < this.y + this.height){\n            this.hovered = true;\n            \n        }else{\n            this.hovered = false;\n                   \n        }\n        this.buttonLayer(context);\n        \n    }\n\n    clickHandler(event,context){\n        event.preventDefault();\n        const mousePos = {\n            x: event.clientX - this.offsetLeft,\n            y: event.clientY - this.offsetTop\n        };\n\n        const last_click = this.clicked;\n  \n        if (mousePos.x > this.x && mousePos.x < (this.x + this.width) && mousePos.y > this.y && mousePos.y < this.y + this.height){\n            context.clearRect(0, 0, 600,390)\n            if(!last_click){\n                this.clicked = true;\n                //console.log('Start Game!');           \n                this.handler();}          \n            \n        }else{\n            this.clicked = false;\n            \n        }\n    }\n\n\n}\n\nexport default Button;","import Sound from './dashboard/sound';\nimport { loadLevel } from \"./loaders\";\nimport {\n    createGroundLayer,\n    createMainBgLayer,\n    createCharacterLayer,\n    createDashboardLayer,\n    createTileMatrix\n} from './levels/level-draw';\nimport {\n    loadBackgroundLayers,\n    loadBackgroundTiles,\n} from \"./sprite-load\";\nimport Layer from './levels/layers';\nimport { createPrincessIdle } from './princess';\nimport { createEnemyWalk } from './enemies';\nimport FixedTimeLoop from './fixed-time-loop';\nimport KeyboardInput from './keyboard-input';\nimport Camera from './camera';\nimport {\n    createTitleLayer,\n    createButtonLayer\n}from './dashboard/dashboard-draw';\nimport Button from './dashboard/button';\n\nclass Game{\n    constructor(ctx, canvas){\n        this.startMusic = new Sound(\"src/audios/background.ogg\");\n        this.gameOverMusic = new Sound(\"src/audios/game-over.mp3\");\n        this.buttonMusic = new Sound(\"src/audios/button.ogg\");\n        this.playerMusic = new Sound(\"src/audios/player-music.mp3\")\n        this.ctx = ctx;\n        this.canvas = canvas;\n        this.offsetLeft = this.canvas.offsetLeft;\n        this.offsetTop = this.canvas.offsetTop;\n        this.start = this.start.bind(this);\n        this.gameOverView = this.gameOverView.bind(this);\n        this.buttons = new Set();\n        this.bgs = [];\n        //this.showMainPage();\n    }\n\n    showMainPage(){\n        \n        this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height)\n        Promise.all([\n            loadBackgroundLayers()\n        ]).then(([bg]) => {\n            const layer = new Layer();\n            layer.layers.push(createMainBgLayer(bg));\n            layer.layers.push(createTitleLayer('Forest', 300, 100, \"Bungee Shade\"));\n            layer.layers.push(createTitleLayer('Princess', 300, 150, \"Bungee Shade\"));\n            layer.layers.push(createTitleLayer('-- Press SPACE to jump --', 300, 290, \"VT323\", 20));\n            layer.layers.push(createTitleLayer('-- Press -> to move --', 300, 310, \"VT323\", 20));\n                              \n            const context = this.ctx;\n            const game = this;\n            const canvas = this.canvas;\n\n            // background music\n            this.gameOverMusic.pause();\n            this.startMusic.loop();\n            this.startMusic.play();\n\n            const startBtn = new Button('start', 260, 220, 80, 30, this.canvas, this.ctx, game);\n            //const quitBtn = new Button('quit', 260, 260, 80, 30, this.canvas);\n\n            function hover(e){\n                e.preventDefault();\n                startBtn.hoverHandler(e, context);\n                //quitBtn.hoverHandler(e, context);\n            }\n\n            function click(e){\n                e.preventDefault();\n                startBtn.clickHandler(e, context);\n                //quitBtn.clickHandler(e, context);\n            }\n\n            canvas.addEventListener('mousemove', hover, true)\n            canvas.addEventListener('click', click, true)\n            \n            startBtn.handler = function(){\n                canvas.removeEventListener('mousemove', hover, true)\n                canvas.removeEventListener('click', click, true)\n                layer.layers = [];\n                game.buttonMusic.play();\n                game.start();\n                return;\n            }\n            \n            // quitBtn.handler = function () {\n            //     canvas.removeEventListener('mousemove', hover, true)\n            //     canvas.removeEventListener('click', click, true)\n            //     layer.layers = [];\n            //     game.showMainPage();\n            //     return\n            // }\n            \n            layer.layers.push(createButtonLayer(startBtn))\n            //layer.layers.push(createButtonLayer(quitBtn))\n\n\n            // mouse events\n  \n            layer.draw(context)\n            \n        })\n    }\n\n    start(){\n        this.ctx.clearRect(0,0,this.canvas.width, this.canvas.height);\n        this.startMusic.pause();\n        Promise.all([\n            loadBackgroundLayers(),\n            loadBackgroundTiles(),\n            loadLevel(\"level-1\"),\n            createPrincessIdle(),\n            //createEnemyWalk(),\n        ]).then(([mainBg, jungleTiles, level, princessIdle]) => {\n            const player = princessIdle.player;\n            //enemy.pos.setVector(600, 0);\n\n            // push to layers array and draw\n            const layer = new Layer();\n            \n            // create matrix\n            createTileMatrix(level.backgrounds, layer.tiles)\n\n            layer.layers.push(createMainBgLayer(mainBg));\n            layer.layers.push(createGroundLayer(jungleTiles, layer.tiles));\n            layer.layers.push(createCharacterLayer(princessIdle));\n            //layer.layers.push(createCharacterLayer(enemy));\n            layer.layers.push(createDashboardLayer(player))\n\n            // add to characters\n            let enemy\n            layer.characters.push(princessIdle);\n            level.enemies.forEach(({name, pos: [x,y]}) => {\n                createEnemyWalk().then(enemy => {\n                    enemy.pos.setVector(x,y);\n                    layer.characters.push(enemy)\n                    layer.layers.push(createCharacterLayer(enemy))\n                });\n            }) \n            //layer.characters.add(enemy);\n\n            // scrolling camera\n            const camera = new Camera;\n\n            // keyboard input\n            const input = new KeyboardInput(princessIdle);\n            input.listenKeys(window);\n\n            // background music\n            this.startMusic.pause();\n            this.gameOverMusic.pause();\n            this.playerMusic.setVolumne(0.8);\n            this.playerMusic.loop();\n            this.playerMusic.play();\n            \n            const game = this;\n            const context = this.ctx;\n            const canvas = this.canvas;\n            const fixedLoop = new FixedTimeLoop(1/60);\n            fixedLoop.update = function update(timestep) {\n                if(!layer.gameOver){\n\n                    layer.update(timestep, camera);\n                    \n                    if (princessIdle.pos.x > 100) {\n                        camera.pos.x = princessIdle.pos.x - 100;\n                    }\n                    layer.draw(context, camera);\n                }else{\n                    layer.layers = null;\n                    layer.characters = null;\n                    princessIdle.player.reset();\n                    princessIdle.player.timer.resetTime();\n                    game.gameOverView();\n                     \n                    return 'Game Over';\n                }\n\n            }\n            fixedLoop.start();\n        });\n    }\n\n    gameOverView(){\n        this.playerMusic.pause();\n        this.gameOverMusic.play();\n        const layer = new Layer();\n\n        layer.layers.push(createTitleLayer('Game Over', 300, 100, \"VT323\"))\n        // createTitleLayer('Game Over', 300, 100, \"VT323\")(this.ctx);\n        const game = this;\n        const context = this.ctx;\n        const canvas = this.canvas;\n\n        const restartBtn = new Button('start', 260, 220, 80, 30, this.canvas);\n        const quitBtn = new Button('quit', 260, 260, 80, 30, this.canvas);\n\n        function hover(e) {\n            e.preventDefault();\n            restartBtn.hoverHandler(e, context);\n            quitBtn.hoverHandler(e, context);\n        }\n\n        function click(e) {\n            e.preventDefault();\n            restartBtn.clickHandler(e, context);\n            quitBtn.clickHandler(e, context);\n        }\n\n        // mouse event\n        canvas.addEventListener('mousemove', hover, true)\n        canvas.addEventListener('click', click, true)\n\n        restartBtn.handler = function () {\n            canvas.removeEventListener('mousemove', hover, true)\n            canvas.removeEventListener('click', click, true)\n            layer.layers = [];\n            game.buttonMusic.play();\n            game.start();\n            return\n        }\n\n        \n        quitBtn.handler = function () {\n            canvas.removeEventListener('mousemove', hover, true)\n            canvas.removeEventListener('click', click, true)\n            layer.layers = [];\n            game.buttonMusic.play();\n            return game.showMainPage();\n            \n        }\n\n        layer.layers.push(createButtonLayer(restartBtn))\n        layer.layers.push(createButtonLayer(quitBtn))\n\n\n        layer.draw(context)\n    }\n}\n\nexport default Game;","import MovingObject from './movements/moving_objects';\nimport {loadPrincessIdle, loadPrincessRun} from './sprite-load';\nimport Jump from './movements/jump';\nimport Run from './movements/run';\n\nimport Player from './player';\n\nexport function createPrincessIdle(){\n    return Promise.all([\n        loadPrincessIdle(),\n        loadPrincessRun()\n    ]\n    ).then(([pIdle, pRun]) => {\n            const princess = new MovingObject();\n            princess.size.setVector(60, 60)\n\n            princess.jump = new Jump();\n            princess.run = new Run();\n            princess.player = new Player();\n            \n            const pRuns = ['run-1', 'run-2', 'run-3']\n            \n            princess.draw = function drawPrincess(context){\n                        \n                let pRunsIdx = (Math.floor(princess.run.distance / 10)) % pRuns.length;\n                if(princess.run.dir !== 0){\n                    pRun.draw(pRuns[pRunsIdx], context, 0,0,3,3, princess.run.dir < 0);\n                }else{\n                    pIdle.draw(\"idle-1\", context, 0, 0, 3, 3);\n                }\n                                \n            }\n            return princess;\n        })\n}","import MovingObject from './movements/moving_objects';\nimport { loadEnemyWalk } from './sprite-load';\nimport EnemyWalk from './movements/enemy_walk';\n\nexport function createEnemyWalk() {\n    return Promise.all([\n        loadEnemyWalk(),\n    ]\n    ).then(([enemyWalk]) => {\n        const enemy = new MovingObject();\n        enemy.size.setVector(45, 55)\n\n        enemy.walk = new EnemyWalk();\n\n        const eWalks = ['walk-1', 'walk-2', 'walk-3']\n\n        enemy.draw = function drawEnemy(context) {\n            \n            let enemyWalkIdx = (Math.floor(enemy.walk.distance / 10)) % eWalks.length; \n          \n            enemyWalk.draw(eWalks[enemyWalkIdx], context, 0, 0, 3, 3, enemy.walk.enemyDir < 0);                        \n        }\n        return enemy;\n    })\n}","import \"./styles/index.scss\";\nimport './scripts/loaders';\nimport Game from './scripts/game';\n\ndocument.addEventListener(\"DOMContentLoaded\", function () {\n  const canvas = document.getElementsByTagName(\"canvas\")[0];\n  const ctx = canvas.getContext(\"2d\", { alpha: false });\n  const offsetLeft = canvas.offsetLeft;\n  const offsetTop = canvas.offsetTop;\n\n  const game = new Game(ctx, canvas);\n  game.showMainPage();\n\n\n});"],"sourceRoot":""}