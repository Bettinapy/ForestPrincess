!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/dist/",n(n.s=1)}([function(e,t,n){},function(e,t,n){"use strict";n.r(t);n(0);function r(e){return new Promise((function(t){var n=new Image;n.addEventListener("load",(function(){t(n)})),n.src=e}))}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sound=document.createElement("audio"),this.sound.src=t,this.sound.setAttribute("preload","auto"),this.sound.setAttribute("controls","none"),this.sound.style.display="none",document.body.appendChild(this.sound)}var t,n,r;return t=e,(n=[{key:"loop",value:function(){this.sound.loop=!0}},{key:"play",value:function(){this.sound.play()}},{key:"pause",value:function(){this.sound.pause()}}])&&i(t.prototype,n),r&&i(t,r),e}();function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t){var n=document.createElement("canvas");return n.height=390,n.width=24e3,e.forEach((function(e){!function(e,t,n){e.ranges.forEach((function(r){for(var i=o(r,4),a=i[0],s=i[1],u=i[2],c=i[3],l=a;l<s;l++)for(var h=u;h<c;h++)n.drawTile(e.tile,t,l,h)}))}(e,n.getContext("2d"),t)})),function(e,t){e.drawImage(n,-t.pos.x,0)}}function c(e){var t=document.createElement("canvas");t.height=60,t.width=60;var n=t.getContext("2d");return function(r,i){n.clearRect(0,0,60,60),e.draw(n),r.drawImage(t,e.pos.x-i.pos.x,e.pos.y-i.pos.y)}}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var h=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.image=t,this.width=n,this.height=r,this.tiles=new Map}var t,n,r;return t=e,(n=[{key:"create",value:function(e,t,n,r,i){var a=this,o=[!1,!0].map((function(e){r||(r=a.width),i||(i=a.height);var o=document.createElement("canvas");o.height=i,o.width=r;var s=o.getContext("2d");return e&&(s.scale(-1,1),s.translate(-15,0)),s.drawImage(a.image,t,n,r,i,0,0,r,i),o}));this.tiles.set(e,o)}},{key:"draw",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=this.tiles.get(e)[o?1:0];t.drawImage(s,n,r,this.width*i,this.height*a)}},{key:"drawTile",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=this.tiles.get(e)[o?1:0];t.drawImage(s,n*this.width,r*this.height,this.width*i,this.height*a)}}])&&l(t.prototype,n),r&&l(t,r),e}();function f(){return r("src/images/main-bg.png").then((function(e){var t=new h(e,600,450);return t.create("mainBg",0,0),t}))}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.table=[]}var t,n,r;return t=e,(n=[{key:"set",value:function(e,t,n){this.table[e]||(this.table[e]=[]),this.table[e][t]=n}},{key:"get",value:function(e,t){return this.table[e]?this.table[e][t]:void 0}}])&&y(t.prototype,n),r&&y(t,r),e}();window.Matrix=d;var v=d;function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var w=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30;p(this,e),this.matrix=t,this.tileSize=n}var t,n,r;return t=e,(n=[{key:"posToIndex",value:function(e){return Math.floor(e/this.tileSize)}},{key:"posToIndexRange",value:function(e,t){for(var n=Math.ceil(t/this.tileSize)*this.tileSize,r=[];e<n;)r.push(this.posToIndex(e)),e+=this.tileSize;return r}},{key:"getByIndex",value:function(e,t){var n=this.matrix.get(e,t),r=t*this.tileSize,i=r+this.tileSize,a=e*this.tileSize,o=a+this.tileSize;if(n)return{tile:n,ytop:r,ybottom:i,xleft:a,xright:o}}},{key:"getByRange",value:function(e,t,n,r){var i=this,a=[];return this.posToIndexRange(e,t).forEach((function(e){i.posToIndexRange(n,r).forEach((function(t){var n=i.getByIndex(e,t);n&&a.push(n)}))})),a}},{key:"matchPos",value:function(e,t){return this.getByIndex(this.posToIndex(e),this.posToIndex(t))}}])&&g(t.prototype,n),r&&g(t,r),e}();function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var b=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.tiles=new w(t)}var t,n,r;return t=e,(n=[{key:"checkCollisionY",value:function(e){var t;if(e.vel.y>0)t=e.pos.y+e.size.y;else{if(!(e.vel.y<0))return;t=e.pos.y}this.tiles.getByRange(e.pos.x,e.pos.x+e.size.x,t,t).forEach((function(t){"flatGround"!==t.tile.name&&"ground"!==t.tile.name&&"greenGrass"!==t.tile.name||(e.vel.y>0?e.pos.y+e.size.y>=t.ytop&&(e.pos.y=t.ytop-e.size.y,e.vel.y=0):e.vel.y<0&&e.pos.y<t.ybottom&&(e.pos.y=t.ybottom,e.vel.y=0))}))}},{key:"checkCollisionX",value:function(e){var t;if(e.vel.x>0)t=e.pos.x+e.size.x;else{if(!(e.vel.x<0))return;t=e.pos.x}this.tiles.getByRange(t,t,e.pos.y,e.pos.y+e.size.y).forEach((function(t){"flatGround"!==t.tile.name&&"ground"!==t.tile.name&&"greenGrass"!==t.tile.name||(e.vel.x>0?e.pos.x+e.size.x>t.xleft&&(e.pos.x=t.xleft-e.size.x,e.vel.x=0,e.walk&&(e.walk.enemyDir=-1,e.walk.distance=0)):e.vel.x<0&&e.pos.x<t.xright&&(e.pos.x=t.xright,e.vel.x=0,e.walk&&(e.walk.enemyDir=1,e.walk.distance=0)))}))}}])&&m(t.prototype,n),r&&m(t,r),e}();function k(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var x=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.characters=t,this.sound=new a("src/audios/collision.wav")}var t,n,r;return t=e,(n=[{key:"check",value:function(e){var t=this;this.characters.forEach((function(n){return n!==e&&!!n.boundaries.isCollide(e.boundaries)&&(console.log("Collide! GAME OVER"),t.sound.play(),!0)}))}}])&&k(t.prototype,n),r&&k(t,r),e}();function T(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var C=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sound=new a("src/audios/drop.wav")}var t,n,r;return t=e,(n=[{key:"check",value:function(e){return e.pos.y+e.size.y>350&&(console.log("Drop! Game Over!"),this.sound.play(),!0)}}])&&T(t.prototype,n),r&&T(t,r),e}();function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var j=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.layers=[],this.tiles=new v,this.characters=new Set,this.charactersCollider=new x(this.characters),this.tileCollider=new b(this.tiles),this.characterDrop=new C,this.gameOver=!1}var t,n,r;return t=e,(n=[{key:"draw",value:function(e,t){this.layers.forEach((function(n){n(e,t)}))}},{key:"update",value:function(e,t){var n=this;this.characters.forEach((function(t){t.jump&&(t.jump.update(t,e),t.run.update(t,e),t.player.update(e)),t.walk&&t.walk.update(t,e),t.pos.x+=t.vel.x*e,n.tileCollider.checkCollisionX(t),t.pos.y+=t.vel.y*e,n.tileCollider.checkCollisionY(t),t.vel.y+=2e3*e,t.jump&&n.characterDrop.check(t)&&(n.gameOver=!0)})),this.characters.forEach((function(e){n.charactersCollider.check(e)&&(n.gameOver=!0)}))}}])&&E(t.prototype,n),r&&E(t,r),e}();function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var S=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.setVector(t,n)}var t,n,r;return t=e,(n=[{key:"setVector",value:function(e,t){this.x=e,this.y=t}}])&&O(t.prototype,n),r&&O(t,r),e}();function P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var A=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pos=t,this.size=n}var t,n,r;return t=e,(n=[{key:"isCollide",value:function(e){return this.getBottom()>e.getTop()&&this.getTop()<e.getBottom()&&this.getLeft()<e.getRight()&&this.getRight()>e.getLeft()}},{key:"getBottom",value:function(){return this.pos.y+this.size.y}},{key:"getTop",value:function(){return this.pos.y}},{key:"getLeft",value:function(){return this.pos.x}},{key:"getRight",value:function(){return this.pos.x+this.size.x}}])&&P(t.prototype,n),r&&P(t,r),e}();function I(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var M=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pos=new S(0,0),this.vel=new S(0,0),this.size=new S(0,0),this.boundaries=new A(this.pos,this.size)}var t,n,r;return t=e,(n=[{key:"update",value:function(e){this.pos.x+=this.vel.x*e,this.pos.y+=this.vel.y*e*1.8}}])&&I(t.prototype,n),r&&I(t,r),e}();function z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var L=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.duration=.1,this.exactTime=0,this.velocityY=500,this.velocityX=20,this.sound=new a("src/audios/jump.wav")}var t,n,r;return t=e,(n=[{key:"start",value:function(){this.exactTime=this.duration,this.sound.play()}},{key:"stop",value:function(){this.exactTime=0}},{key:"update",value:function(e,t){this.exactTime>0&&(e.vel.y=-this.velocityY,this.exactTime-=t)}}])&&z(t.prototype,n),r&&z(t,r),e}();function D(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var B=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.speed=300,this.dir=0,this.distance=0}var t,n,r;return t=e,(n=[{key:"update",value:function(e,t){e.vel.x=this.speed*this.dir*t,this.dir?this.distance+=Math.abs(e.vel.x*t):this.distance=0}}])&&D(t.prototype,n),r&&D(t,r),e}();function R(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function H(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var G=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;R(this,e),this.time=t}var t,n,r;return t=e,(n=[{key:"updateTime",value:function(e){this.time+=e}},{key:"draw",value:function(e,t,n){e.font="30px VT323",e.fillStyle="white",e.fillText("Time: ".concat(Math.round(this.time)),t,n)}}])&&H(t.prototype,n),r&&H(t,r),e}();function U(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var V=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.score=0,this.timer=new G}var t,n,r;return t=e,(n=[{key:"update",value:function(e){this.timer.updateTime(e)}}])&&U(t.prototype,n),r&&U(t,r),e}();function Y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return _(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function X(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var F=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.speed=4e3,this.enemyDir=-1,this.distance=0}var t,n,r;return t=e,(n=[{key:"update",value:function(e,t){e.vel.x=this.speed*this.enemyDir*t,this.distance+=Math.abs(e.vel.x*t)}}])&&X(t.prototype,n),r&&X(t,r),e}();function $(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return q(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return q(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function q(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function K(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function N(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var J=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/60,r=arguments.length>1?arguments[1]:void 0;K(this,e),this.gameOver=r;var i=0,a=0;this.updateTime=function(e){if(i+=(e-a)/1e3,!t.gameOver){for(;i>n;)t.update(n),i-=n;a=e,requestAnimationFrame(t.updateTime)}}}var t,n,r;return t=e,(n=[{key:"start",value:function(){requestAnimationFrame(this.updateTime)}}])&&N(t.prototype,n),r&&N(t,r),e}();function Q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var W=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rightPressed=!1,this.leftPressed=!1,this.spacePressed=!1,this.character=t,this.keyDownHandler=this.keyDownHandler.bind(this),this.keyUpHandler=this.keyUpHandler.bind(this)}var t,n,r;return t=e,(n=[{key:"keyDownHandler",value:function(e){e.preventDefault(),39===e.keyCode?(this.character.run.dir=e.keyCode,this.rightPressed=!0):37===e.keyCode&&(this.character.run.dir=-e.keyCode,this.leftPressed=!0),32===e.keyCode&&0===this.character.jump.exactTime&&Math.abs(this.character.vel.y)<34&&(this.character.jump.start(),this.spacePressed=!0)}},{key:"keyUpHandler",value:function(e){e.preventDefault(),39===e.keyCode?(this.character.run.dir=0,this.rightPressed=!1):37===e.keyCode&&(this.character.run.dir=0,this.leftPressed=!1),32===e.keyCode&&(this.character.jump.stop(),this.spacePressed=!1)}},{key:"listenKeys",value:function(e){e.addEventListener("keydown",this.keyDownHandler),e.addEventListener("keyup",this.keyUpHandler)}}])&&Q(t.prototype,n),r&&Q(t,r),e}();var Z=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pos=new S(0,0)};function ee(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var te=function(){function e(t,n,r,i,a,o,s,u){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.x=n,this.y=r,this.width=i,this.height=a,this.clicked=!1,this.hovered=!1,this.text=t,this.canvas=o,this.context=s,this.offsetLeft=this.canvas.offsetLeft,this.offsetTop=this.canvas.offsetTop,this.game=u,this.draw();var c=document.createElement("canvas");c.height=390,c.width=600,this.buttonBufferContext=c.getContext("2d")}var t,n,r;return t=e,(n=[{key:"getMousePos",value:function(e){return{x:e.clientX-this.offsetLeft,y:e.clientY-this.offsetTop}}},{key:"isInside",value:function(e){return e.x>this.x&&e.x<this.x+this.width&&e.y<this.y+this.heigth&&e.y>this.y}},{key:"hoverHandler",value:function(e){var t=e.clientX-this.offsetLeft,n=e.clientY-this.offsetTop;t>this.x&&t<this.x+this.width&&n>this.y&&n<this.y+this.height?(this.hovered=!0,this.draw()):(this.hovered=!1,this.draw())}},{key:"clickHandler",value:function(e){var t=e.clientX-this.offsetLeft,n=e.clientY-this.offsetTop;t>this.x&&t<this.x+this.width&&n>this.y&&n<this.y+this.height?(this.clicked=!0,console.log("Start Game!"),this.handler(this.game)):this.clicked=!1}},{key:"draw",value:function(){var e=document.createElement("canvas");e.height=this.canvas.height,e.width=this.canvas.width;var t=e.getContext("2d");t.clearRect(0,0,e.height,e.width),t.beginPath(),t.moveTo(this.x+3,this.y),t.arcTo(this.x+this.width,this.y,this.x+this.width,this.y+this.height,3),t.arcTo(this.x+this.width,this.y+this.height,this.x,this.y+this.height,3),t.arcTo(this.x,this.y+this.height,this.x,this.y,3),t.arcTo(this.x,this.y,this.x+this.width,this.y,3),t.closePath(),t.strokeStyle="white",t.stroke(),this.hovered?(t.fillStyle="#57AF55",t.fill()):(t.fillStyle="green",t.fill()),t.fillStyle="white",t.font="25px VT323",t.measureText(this.text);var n=this.x+this.width/2,r=this.y+this.height/2+25/3;t.textAlign="center",t.fillText(this.text,n,r),this.context.drawImage(e,0,0)}},{key:"listenMouse",value:function(){this.canvas.addEventListener("mousemove",this.hoverHandler.bind(this)),this.canvas.addEventListener("click",this.clickHandler.bind(this))}}])&&ee(t.prototype,n),r&&ee(t,r),e}();function ne(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return re(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return re(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function re(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ie(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ae=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.bgMusic=new a("src/audios/background.ogg"),this.ctx=t,this.canvas=n,this.start=this.start.bind(this)}var t,n,i;return t=e,(n=[{key:"showMainPage",value:function(){var e=this;Promise.all([f()]).then((function(t){!function(e,t){e.draw("mainBg",t,0,0,2,2)}(ne(t,1)[0],e.ctx),function(e){var t=document.createElement("canvas");t.height=300,t.width=300;var n=t.getContext("2d");n.font="45px Bungee Shade",n.fillStyle="white",n.textAlign="center",n.fillText("Forest",150,40),n.fillText("Princess",150,100),e.drawImage(t,160,80)}(e.ctx);var n=e,r=new te("start",260,220,80,30,e.canvas,e.ctx,n);r.handler=function(e){e.start()},r.listenMouse()}))}},{key:"start",value:function(){var e,t=this;Promise.all([f(),r("src/images/jungle_tileset.png").then((function(e){var t=new h(e,30,30);return t.create("flatGround",70,225),t.create("ground",354,210),t.create("greenGrass",161,33),t.create("obstacleGrass",64,34,80,60),t})),(e="level-1",fetch("src/scripts/levels/".concat(e,".json")).then((function(e){return e.clone().json()}))),Promise.all([r("src/images/princess/Idle.png").then((function(e){var t=new h(e,30,30);return t.create("idle-1",24,11),t.create("idle-2",24,59),t.create("idle-3",24,303),t})),r("src/images/princess/Run.png").then((function(e){var t=new h(e,30,30);return t.create("run-1",24,11),t.create("run-2",24,59),t.create("run-3",24,153),t}))]).then((function(e){var t=Y(e,2),n=t[0],r=t[1],i=new M;i.size.setVector(60,60),i.jump=new L,i.run=new B,i.player=new V;var a=["run-1","run-2","run-3"];return i.draw=function(e){var t=Math.floor(i.run.distance/10)%a.length;0!==i.run.dir?r.draw(a[t],e,0,0,3,3,i.run.dir<0):n.draw("idle-1",e,0,0,3,3)},i})),Promise.all([r("src/images/enemies/walk.png").then((function(e){var t=new h(e,20,20);return t.create("walk-1",29,14),t.create("walk-2",29,60),t.create("walk-3",29,109),t}))]).then((function(e){var t=$(e,1)[0],n=new M;n.size.setVector(60,60),n.walk=new F;var r=["walk-1","walk-2","walk-3"];return n.draw=function(e){var i=Math.floor(n.walk.distance/10)%r.length;t.draw(r[i],e,0,0,3,3,n.walk.enemyDir<0)},n}))]).then((function(e){var n=ne(e,5),r=n[0],i=n[1],s=n[2],l=n[3],h=n[4];h.pos.setVector(600,0);var f,y,d,v=new j;v.layers.push(function(e){var t=document.createElement("canvas");return t.height=390,t.width=1250,t.getContext("2d"),function(t,n){e.draw("mainBg",t,0,0,2,2)}}(r)),v.layers.push(u(s.backgrounds,i)),v.layers.push(c(l)),v.layers.push(c(h)),v.layers.push((f=l,function(e,t){f.player.timer.draw(e,450,50)})),v.characters.add(l),v.characters.add(h),y=s.backgrounds,d=v.tiles,y.forEach((function(e){e.ranges.forEach((function(t){for(var n=o(t,4),r=n[0],i=n[1],a=n[2],s=n[3],u=r;u<i;u++)for(var c=a;c<s;c++)d.set(u,c,{name:e.tile})}))}));var p=new Z;new W(l).listenKeys(window),new a("src/audios/background.ogg").play();var g=t.ctx,w=new J(v.gameOver);w.update=function(e){v.update(e,p),l.pos.x>300&&(p.pos.x=l.pos.x-300),v.draw(g,p)},w.start()}))}}])&&ie(t.prototype,n),i&&ie(t,i),e}();document.addEventListener("DOMContentLoaded",(function(){var e=document.getElementsByTagName("canvas")[0],t=e.getContext("2d"),n=(e.offsetLeft,e.offsetTop,new ae(t,e));n.showMainPage(),window.addEventListener("keydown",(function(e){e.preventDefault(),82===e.keyCode&&n.start()}))}))}]);
//# sourceMappingURL=main.js.map